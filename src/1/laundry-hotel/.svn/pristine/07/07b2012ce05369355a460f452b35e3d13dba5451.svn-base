<Window x:Class="ETextsys.Terminal.View.Warehouse.QRCodeCheckOut"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ETextsys.Terminal.View.Warehouse"
        mc:Ignorable="d" Style="{DynamicResource FuncWindow}" WindowStartupLocation="CenterScreen"
        Title="QRCodeBinding" Activated="Window_Activated">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="126"></RowDefinition>
            <RowDefinition></RowDefinition>
            <RowDefinition Height="92"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Background="{DynamicResource Headerbg}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Border Name="ReaderBorder" HorizontalAlignment="Left" Margin="25,0,0,0" Width="110" Height="110" CornerRadius="115" Tag="{Binding Model.ReaderState}">
                <Border.Background>
                    <VisualBrush>
                        <VisualBrush.Visual>
                            <MediaElement Name="ReaderME" Cursor="Hand" UnloadedBehavior="Manual" Source="{Binding Model.ReaderLight}" >
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MediaEnded">
                                        <i:InvokeCommandAction Command="{Binding MediaEndedCommand}" CommandParameter="{Binding ElementName=ReaderME}"></i:InvokeCommandAction>
                                    </i:EventTrigger>

                                </i:Interaction.Triggers>
                            </MediaElement>
                        </VisualBrush.Visual>
                    </VisualBrush>
                </Border.Background>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="PreviewMouseDown">
                        <i:InvokeCommandAction Command="{Binding ReaderStateChanged}" CommandParameter="{Binding ElementName=ReaderBorder}"></i:InvokeCommandAction>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </Border>

            <TextBlock Grid.Column="1" Style="{DynamicResource FuncTitle}" Margin="0,0,0,25" Text="溯源码校验"></TextBlock>
            <Button Grid.Column="2" Style="{DynamicResource BackBtn}" Command="{Binding CloseModal}" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,15,15,0"></Button>
        </Grid>
        <Grid Grid.Row="1" Margin="20,0,20,5">
            <Grid.RowDefinitions>
                <RowDefinition Height="65"></RowDefinition>
                <RowDefinition Height="370"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
                <ColumnDefinition Width="350"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Border Grid.Row="1" Grid.Column="0" Background="#FFF" CornerRadius="20,20,30,30">
                <StackPanel>
                    <Canvas Height="320">
                        <Image Source="{DynamicResource QRCodeRFIDBG}" Width="234" Height="254" Margin="58,33,0,0"></Image>
                        <Border Visibility="{Binding Model.RFIDReaderVisibility}"  Margin="200,60,0,0" Width="101" Height="84" CornerRadius="0"  >
                            <Border.Background>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <MediaElement Name="RFIDReader" Cursor="Hand" UnloadedBehavior="Manual" Source="Skins/Default/Images/xinhao2.gif" >
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="MediaEnded">
                                                    <i:InvokeCommandAction Command="{Binding MediaEndedCommand}" CommandParameter="{Binding ElementName=RFIDReader}"></i:InvokeCommandAction>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </MediaElement>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </Border.Background>
                        </Border>
                    </Canvas>
                    <Border Height="50" Background="{Binding Model.RFIDColor}" CornerRadius="0,0,30,30">
                        <TextBlock FontFamily="Microsoft YaHei" FontSize="24" Foreground="{Binding Model.RFIDTextColor}" Text="{Binding Model.RFIDText}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                    </Border>
                </StackPanel>
            </Border>
            <TextBox Text="{Binding Model.QRCode,UpdateSourceTrigger=PropertyChanged}" Grid.Column="3" Height="40" Width="300" Name="txtQRCode"  VerticalContentAlignment="Center" FontSize="18"></TextBox>
            <TextBox Text="{Binding Model.RFIDTag}"  Width="300" Height="40" VerticalContentAlignment="Center" FontSize="18"></TextBox>
            <Button Width="0" Height="0" IsDefault="True" Command="{Binding QRCodeScanCommand}"></Button>
            <!--<Image Source="{Binding Model.BindingState}" Grid.Row="1" Grid.Column="1" Width="244" Height="244"></Image>-->
            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Model.BindingState}" Foreground="{Binding Model.BindingStateColor}" FontSize="50" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
            <Border Grid.Row="1" Grid.Column="2" Background="#FFF" CornerRadius="20,20,30,30">
                <StackPanel>
                    <Canvas Height="320">
                        <Border   Margin="45,30,0,0" Width="260" Height="260" CornerRadius="0" Visibility="{Binding Model.QRCodeScanVisibility}" >
                            <Border.Background>
                                <VisualBrush>
                                    <VisualBrush.Visual>
                                        <MediaElement Name="QRCodeReader" Cursor="Hand" UnloadedBehavior="Manual" Source="Skins/Default/Images/saoma2.gif" >
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="MediaEnded">
                                                    <i:InvokeCommandAction Command="{Binding MediaEndedCommand}" CommandParameter="{Binding ElementName=QRCodeReader}"></i:InvokeCommandAction>
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </MediaElement>
                                    </VisualBrush.Visual>
                                </VisualBrush>
                            </Border.Background>
                        </Border>
                        <Image Visibility="{Binding Model.QRCodeVisibility}" Source="{DynamicResource QRCodeSuccessIcon}" Width="260" Height="260" Margin="45,30,0,0"></Image>
                    </Canvas>
                    <Border Height="50" Background="{Binding Model.QRCodeColor}" CornerRadius="0,0,30,30">
                        <TextBlock FontFamily="Microsoft YaHei" FontSize="24" Foreground="{Binding Model.QRCodeTextColor}" Text="{Binding Model.QRCodeText}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                    </Border>
                </StackPanel>
            </Border>

        </Grid>
        <Grid Grid.Row="2" Grid.ColumnSpan="3" VerticalAlignment="Bottom" Background="{DynamicResource ToolsBottom}" Height="92">

            <Grid Width="500" HorizontalAlignment="Right" Margin="0,0,20,0">
            </Grid>
        </Grid>

    </Grid>
</Window>