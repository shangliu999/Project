<Window x:Class="ETextsys.Terminal.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:local="clr-namespace:ETextsys.Terminal"  
        xmlns:lw="clr-namespace:ETextsys.Terminal.View.Choose"
        xmlns:cvn="clr-namespace:ETextsys.Terminal.Utilities"
        mc:Ignorable="d" Style="{StaticResource FuncWindow}" 
        WindowStartupLocation="CenterScreen" Title="主窗体">
    <Window.Resources>
        <cvn:VisibilityConverter x:Key="vconverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="120"/>
            <RowDefinition Height="70"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Image Source="{StaticResource MainLogo}" Width="142" Height="82" HorizontalAlignment="Left" Margin="50,20,0,0"/>
            <Border HorizontalAlignment="Left" VerticalAlignment="Top" CornerRadius="0,0,25,25" Background="White" Margin="320,0,0,0">
                <!--快捷菜单-->
                <ListBox ItemsSource="{Binding}" DataContext="{Binding Model.FuncM}" Background="Transparent" BorderThickness="0">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"></StackPanel>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <Button Width="80" Height="100" Margin="0 0 34 0" Name="itemBtn" Content="{Binding Name}"
                                        Command="{Binding DataContext.SelectionChangedCmd, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}" 
                                        CommandParameter="{Binding ID}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <Border Name="sp" Background="#ffffff" Opacity="0.6" CornerRadius="20">
                                                <StackPanel VerticalAlignment="Center">
                                                    <Image Source="{Binding ImageUrl}" Width="60"/>
                                                    <TextBlock HorizontalAlignment="Center" FontFamily="Microsoft YaHei Blod" FontSize="18" Text="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"></TextBlock>
                                                </StackPanel>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="Button.IsPressed" Value="True">
                                                    <Trigger.Setters>
                                                        <Setter TargetName="sp" Property="Background" Value="#A3CEFF"></Setter>
                                                    </Trigger.Setters>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <!-- 设置控件模板 -->
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <Border Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                 TextBlock.Foreground="{TemplateBinding Foreground}"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>
            </Border>
        </Grid>
        <Grid Grid.Row="1">
            <Button Style="{StaticResource MainLeftBtn}" HorizontalAlignment="Left" Margin="20,0,0,0" Command="{Binding ChangePageCommond}" CommandParameter="L" Visibility="{Binding Model.LVisibility}"></Button>
            <TextBlock HorizontalAlignment="Center" Style="{StaticResource txtMainTitle}" Text="{Binding Model.Title}"></TextBlock>
            <Button Style="{StaticResource MainRightBtn}" HorizontalAlignment="Right" Margin="0,0,20,0" Command="{Binding ChangePageCommond}" CommandParameter="R" Visibility="{Binding Model.RVisibility}"></Button>
        </Grid>
        <Canvas Grid.Row="2" Margin="50,0,50,0">
            <!--左上-->
            <ListBox Canvas.Left="0" ItemsSource="{Binding}" DataContext="{Binding Model.FuncInFactory}" Background="Transparent" BorderThickness="0">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="2"></UniformGrid>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <Button Width="210" Height="120" Margin="0 20 20 0" Name="itemBtn" Content="{Binding Name}" IsEnabled="{Binding IsEnabled}"
                                        Command="{Binding DataContext.SelectionChangedCmd, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}" 
                                        CommandParameter="{Binding ID}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <Border Name="sp" Background="#ffffff" Opacity="0.6" CornerRadius="6">
                                            <Grid VerticalAlignment="Center">
                                                <Image Source="{StaticResource wuxiao}" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-5,0,0" Height="116" Visibility="{Binding IsEnabled,Converter={StaticResource vconverter}}"/>
                                                <StackPanel VerticalAlignment="Center">
                                                    <Image Name="img" Source="{Binding ImageUrl}" Width="60"/>
                                                    <TextBlock HorizontalAlignment="Center" FontFamily="Microsoft YaHei Blod" FontSize="18" Text="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"></TextBlock>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="Button.IsPressed" Value="True">
                                                <Trigger.Setters>
                                                    <Setter TargetName="sp" Property="Background" Value="#A3CEFF"></Setter>
                                                </Trigger.Setters>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <!-- 设置控件模板 -->
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                 TextBlock.Foreground="{TemplateBinding Foreground}"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>
            <!--左下-->
            <Grid Canvas.Top="{Binding Model.QTop}">
                <Border CornerRadius="6" Margin="0,10,0,0" Background="#333333" Opacity="0.2">
                </Border>
                <StackPanel>
                    <Border BorderThickness="0 0 0 2" BorderBrush="#ffffff" Margin="10,10,10,0">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="{StaticResource MainQuery}" Width="40" Height="40"/>
                            <TextBlock FontFamily="Microsoft YaHei" Foreground="#ffffff" FontSize="16" VerticalAlignment="Center">单据/汇总</TextBlock>
                        </StackPanel>
                    </Border>
                    <ListBox ItemsSource="{Binding}" DataContext="{Binding Model.FuncQ}" Background="Transparent" BorderThickness="0" Margin="0,0,10,10">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="3"></UniformGrid>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <Button Width="134" Height="180" Margin="10 10 0 0" Name="itemBtn" Content="{Binding Name}"
                                        Command="{Binding DataContext.SelectionChangedCmd, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}" 
                                        CommandParameter="{Binding ID}">
                                        <Button.Template>
                                            <ControlTemplate>
                                                <Border Name="sp" Background="#ffffff" Opacity="1" CornerRadius="6">
                                                    <StackPanel VerticalAlignment="Center">
                                                        <Image Source="{Binding ImageUrl}" Width="60"/>
                                                        <TextBlock HorizontalAlignment="Center" FontFamily="Microsoft YaHei Blod" FontSize="18" Text="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"></TextBlock>
                                                    </StackPanel>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="Button.IsPressed" Value="True">
                                                        <Trigger.Setters>
                                                            <Setter TargetName="sp" Property="Background" Value="#A3CEFF"></Setter>
                                                        </Trigger.Setters>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Border Background="{TemplateBinding Background}">
                                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                 TextBlock.Foreground="{TemplateBinding Foreground}"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>
                </StackPanel>
            </Grid>
            <!--右-->
            <ListBox Canvas.Right="0" ItemsSource="{Binding}" DataContext="{Binding Model.FuncInC}" Background="Transparent" BorderThickness="0">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="2"></UniformGrid>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <Button Width="210" Height="120" Margin="0 20 20 0" Name="itemBtn" Content="{Binding Name}" IsEnabled="{Binding IsEnabled}"
                                        Command="{Binding DataContext.SelectionChangedCmd, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=Window}}" 
                                        CommandParameter="{Binding ID}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <Border Name="sp" Background="#ffffff" Opacity="0.6" CornerRadius="6">
                                            <Grid VerticalAlignment="Center">
                                                <Image Source="{StaticResource wuxiao}" HorizontalAlignment="Right" VerticalAlignment="Top" Height="116" Margin="0,-5,0,0" Visibility="{Binding IsEnabled,Converter={StaticResource vconverter}}"/>
                                                <StackPanel VerticalAlignment="Center">
                                                    <Image Name="img" Source="{Binding ImageUrl}" Width="60"/>
                                                    <TextBlock HorizontalAlignment="Center" FontFamily="Microsoft YaHei Blod" FontSize="18" Text="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"></TextBlock>
                                                </StackPanel>                                               
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="Button.IsPressed" Value="True">
                                                <Trigger.Setters>
                                                    <Setter TargetName="sp" Property="Background" Value="#A3CEFF"></Setter>
                                                </Trigger.Setters>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                 VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                 TextBlock.Foreground="{TemplateBinding Foreground}"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>
        </Canvas>
        <lw:LoadingWait Grid.RowSpan="3" Visibility="{Binding Model.WaitVisibled}" Tag="{Binding Model.WaitContent}"></lw:LoadingWait>
    </Grid>
</Window>
