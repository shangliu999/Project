
@{
    ViewBag.Title = "ViewPassword";
}

<div class="row wrapper wrapper-content animated fadeInRight" style="padding-top:75px;">
    <div class="ibox-content">
        <div>
            <h1>修改密码</h1>
        </div>
        <div class="ibox-content">
            <form class="form-horizontal" id="UpdatePWDForm">
                <div class="form-group">
                    <label class="col-lg-2 control-label">旧密码：</label>
                    <div class="col-lg-3">
                        <input type="password" placeholder="旧密码" class="form-control" id="pwdold">
                    </div>
                    <div class="col-lg-4" style="color:orangered">

                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2 control-label">新密码：</label>
                    <div class="col-lg-3">
                        <input type="password" placeholder="新密码" class="form-control" id="pwdnew1">
                    </div>
                    <div class="col-lg-4" style="color:orangered">

                    </div>
                </div>
                <div class="form-group">
                    <label class="col-lg-2 control-label">确认新密码：</label>
                    <div class="col-lg-3">
                        <input type="password" placeholder="确认新密码" class="form-control" id="pwdnew2">
                    </div>
                    <div class="col-lg-4" style="color:orangered">

                    </div>
                </div>
                <div class="form-group" style="text-align:left;">
                    <label class="col-lg-2 control-label">&nbsp;</label>
                    <button class="btn btn-success" type="button" id="btnSubmit"><i class="fa fa-save"></i>提交</button>
                    <button class="btn btn-danger" type="button" id="btnCancel"><i class="fa fa-remove"></i>取消</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script src="@Url.Content("~/Scripts/jquery.md5.js")"></script>

<script>
    $("#btnSubmit").click(function () {
        var old = $("#pwdold").val();
        var new1 = $("#pwdnew1").val();
        var new2 = $("#pwdnew2").val();

        var isok = true;
        if (old == "" || old == undefined || old == null) {
            $("#pwdold").parent().next().html("旧密码不能为空.");
            isok = false;
        } else {
            $("#pwdold").parent().next().html("");
        }
        if (new1 == "" || new1 == undefined || new1 == null) {
            $("#pwdnew1").parent().next().html("新密码不能为空.");
            isok = false;
        } else {
            $("#pwdnew1").parent().next().html("");
        }
        if (new2 == "" || new2 == undefined || new2 == null) {
            $("#pwdnew2").parent().next().html("确认新密码不能为空.");
            isok = false;
        } else {
            if (new1 != new2) {
                $("#pwdnew2").parent().next().html("新密码和确认新密码不一致，请重新输入.");
                isok = false;
            } else {
                $("#pwdnew2").parent().next().html("");
            }
        }

        if (!isok) {
            return;
        }

        var url = "@Url.Action("UpdatePassword", "Login")";
        var v = { "oldPwd": $.md5(old), "newPwd1": $.md5(new1), "newPwd2": $.md5(new2) };

        $.ajax({
            type: "post",
            data: v,
            dataType: "json",
            url: url,
            success: function (result) {
                if (result.ResultCode == 0) {
                    swal("提示", "修改成功.");
                } else {
                    swal("提示", result.ResultMsg);
                }
                return false;
            }
        });
    });

    $("#btnCancel").click(function () {
        $("#UpdatePWDForm input").val("");
    });
</script>
