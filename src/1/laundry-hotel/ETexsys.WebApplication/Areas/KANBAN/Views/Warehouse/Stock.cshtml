
@{
    ViewBag.Title = "库存";
}

<div class="child">
    <div class="table-responsive dataTables_wrapper" id="dataReport">
    </div>
</div>

<script>
    $(document).ready(function () {
        getdata();

        setInterval(function () {
            getdata();
        }, 1000 * 3);
    });
    function getdata() {
        var _url = "@Url.Action("GetStock", "Warehouse")";

        $.ajax({
            type: "post",
            data: {},
            url: _url + "?t=" + new Date().getTime(),
            cache: false,
            beforeSend: function () {
                //$("#dataReport").children().remove();
                //var div = $("<div></div>").addClass("list-group").css({ "margin-top": "20%", "width": "70%", "text-align": "center" });
                //var label = $("<label style='font-size:48px;'>加载中...</label>");
                //div.append(label);
                //$("#dataReport").append(div);
            },
            success: function (result) {
                var it, table, thread, tr;

                table = $("<table></table>").addClass("table").addClass("table-bordered").addClass("table-hover");
                tr = $("<tr></tr>");
                $("<th style='text-align:left;'>品牌</th>").appendTo(tr);
                $("<th style='text-align:left;'>类型</th>").appendTo(tr);
                $("<th style='text-align:right;'>数量</th>").appendTo(tr);
                $("<th style='text-align:left;'>品牌</th>").appendTo(tr);
                $("<th style='text-align:left;'>类型</th>").appendTo(tr);
                $("<th style='text-align:right;'>数量</th>").appendTo(tr);
                $(table).append(tr);

                for (var j = 0; j < result.length; j++) {
                    it = result[j];
                    tr = $("<tr></tr>");
                    $("<td style='text-align:left;padding-right:5px;'>" + it.BrandName1 + "</td>").appendTo(tr);
                    $("<td style='text-align:left;padding-left:5px;'>" + it.ClassName1 + "</td>").appendTo(tr);
                    $("<td style='text-align:right;padding-left:0px;padding-right:5px;'>" + it.Quantity1 + "</td>").appendTo(tr);
                    $("<td style='text-align:left;padding-right:5px;'>" + it.BrandName2 + "</td>").appendTo(tr);
                    $("<td style='text-align:left;padding-left:5px'>" + it.ClassName2 + "</td>").appendTo(tr);
                    $("<td style='text-align:right;padding-left:0px;padding-right:5px;'>" + (it.Quantity2 == 0 ? "" : it.Quantity2) + "</td>").appendTo(tr);
                    $(table).append(tr);
                }

                $("#dataReport").children().remove();
                $("#dataReport").append(table);
            }
        });
    }

</script>
